<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>استخراج منشورات تيليجرام</title>
    <style>
        body { font-family: Arial, sans-serif; direction: rtl; text-align: right; background: #f5f8fa; padding: 20px; }
        .tweet-container {
            width: 500px; background: white; border-radius: 10px;
            padding: 15px; box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
            margin: auto; margin-bottom: 20px;
        }
        .tweet-header { display: flex; align-items: center; }
        .tweet-profile-pic { width: 50px; height: 50px; border-radius: 50%; margin-left: 10px; }
        .tweet-author { font-weight: bold; }
        .tweet-time { color: gray; font-size: 12px; }
        .tweet-content { margin: 10px 0; font-size: 16px; line-height: 1.4; }
        .tweet-footer { display: flex; justify-content: space-between; font-size: 14px; color: gray; margin-top: 10px; }
        .tweet-media img, .tweet-media video { width: 100%; margin-top: 10px; border-radius: 5px; }
    </style>
</head>
<body>

<div id="tweets"></div>

<script>
    const telegramPostURLs = [
        "https://t.me/hassanalihsn/13051?embed=1&mode=tme",
        "https://t.me/hassanalihsn/13052?embed=1&mode=tme",
        "https://t.me/hassanalihsn/13053?embed=1&mode=tme"
    ]; // يمكنك إضافة المزيد من الروابط هنا

    async function fetchPostData(url) {
        try {
            let response = await fetch(url);
            let html = await response.text();
            let parser = new DOMParser();
            let doc = parser.parseFromString(html, "text/html");

            let author = doc.querySelector(".tgme_widget_message_author")?.innerText.trim() || "غير معروف";
            let content = doc.querySelector(".tgme_widget_message_text")?.innerText.trim() || "لا يوجد محتوى نصي";
            let time = doc.querySelector(".datetime")?.getAttribute("datetime") || "غير متوفر";
            let views = doc.querySelector(".tgme_widget_message_views")?.innerText.trim() || "غير متوفر";
            let reactions = [...doc.querySelectorAll(".tgme_widget_message_reaction")].map(e => e.innerText).join(" ") || "لا توجد تفاعلات";
            let replies = doc.querySelector(".tgme_widget_message_replies")?.innerText.trim() || "0 تعليق";

            // استخراج جميع الصور بجميع الصيغ
            let images = [...doc.querySelectorAll(".tgme_widget_message_photo_wrap")].map(e => e.style.backgroundImage.match(/url'(.*?)'/)?.[1]);

            // استخراج جميع الفيديوهات
            let videos = [...doc.querySelectorAll(".tgme_widget_message_video video")].map(e => e.src);

            let mediaHTML = "";
            images.forEach(img => { mediaHTML += `<img src="${img}" alt="صورة">`; });
            videos.forEach(vid => { mediaHTML += `<video controls><source src="${vid}" type="video/mp4"></video>`; });

            return `
                <div class="tweet-container">
                    <div class="tweet-header">
                        <img src="https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png" class="tweet-profile-pic">
                        <div>
                            <div class="tweet-author">${author}</div>
                            <div class="tweet-time">${time}</div>
                        </div>
                    </div>
                    <div class="tweet-content">${content}</div>
                    <div class="tweet-media">${mediaHTML}</div>
                    <div class="tweet-footer">
                        <div>👀 ${views}</div>
                        <div>💬 ${replies}</div>
                        <div>🔥 ${reactions}</div>
                    </div>
                </div>
            `;
        } catch (error) {
            console.error(`❌ فشل في جلب المنشور من: ${url}`, error);
            return `<div class="tweet-container"><p>❌ فشل في تحميل المنشور.</p></div>`;
        }
    }

    async function displayPosts() {
        let postsHTML = "";
        for (let url of telegramPostURLs) {
            postsHTML += await fetchPostData(url);
        }
        document.getElementById("tweets").innerHTML = postsHTML;
    }

    displayPosts();
</script>

</body>
</html>
